---
title: "Sidechain (without, then with)"
clock:
  bpm: 60.0
  time-signature:
    - 4
    - 4
devices:
  - instrument:
      - instrument-1
      - welsh:
        - midi-in: 1
        - name: acid-bass
  - instrument:
      - instrument-2
      - welsh:
        - midi-in: 2
        - name: acid-bass
  - instrument:
      - drum-1
      - drumkit:
        - midi-in: 10
        - name: "707"
  - effect:
      - compressor-1
      - compressor:
          threshold: 1.0
          ratio: 0.2 # lots of compression so we can easily hear the difference
          attack: 0.0 # TODO: currently ignored
          release: 0.0 # TODO: currently ignored
  - effect:
      - compressor-2
      - compressor:
          threshold: 1.0 # this will be automated, so the initial value is meaningless
          ratio: 0.2 # lots of compression so we can easily hear the difference
          attack: 0.0 # TODO: currently ignored
          release: 0.0 # TODO: currently ignored
  - controller:
      - sidechain-2
      - signal-passthrough-controller: # All these parameters are ignored.
        - midi-in: 0
          midi-out: 0
patch-cables:
  - [instrument-1, compressor-1, main-mixer]
  - [instrument-2, compressor-2, main-mixer]
  - [drum-1, sidechain-2, main-mixer]
controls:
  # this hooks up the sidechain-1's control output to the compressor-2's
  # threshold control input.
  - id: sidechain-drums-to-instrument-2
    source: sidechain-2
    target:
      id: compressor-2
      param: threshold
patterns:
  - id: on-then-off-1
    note-value: sixteenth
    notes:
      - [48, 48, 48, 48, 48, 48, 46, 46, 00, 00, 00, 00, 00, 00, 00, 00]
  - id: off-then-on-1
    note-value: sixteenth
    notes:
      - [00, 00, 00, 00, 00, 00, 00, 00, 48, 48, 48, 48, 48, 48, 46, 46]
  - id: silence-1
    note-value: whole
    notes:
      - [0]
  - id: bass-on-each-beat
    note-value: sixteenth
    notes:
      - [39, 00, 39, 00, 39, 00, 39, 00, 39, 00, 39, 00, 39, 00, 39, 00] # Clap
tracks:
  # This track plays first, without active (sidechained) compression
  - id: track-1
    midi-channel: 1
    patterns: [on-then-off-1]
  # This track plays second, with sidechaining
  - id: track-2
    midi-channel: 2
    patterns: [off-then-on-1]
  # The clap track is the sidechain source
  - id: track-3
    midi-channel: 10
    patterns: [bass-on-each-beat]
